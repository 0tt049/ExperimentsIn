<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "README";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 class="title">Experiments In</h1>
<p>A bunch of stuff I&#8217;m interested in</p>
<h2>Experiments in Ray Tracing</h2>
<p>A port of the book <a href="https:raytracing.github.io/books/RayTracingInOneWeekend.html">Ray Tracing in One Weekend</a> by <a href="https://github.com/petershirley">Peter Shirley</a> to the Ruby programming language.</p>
<h4>Introduction</h4>
<p>As far as I know there are two ways one could programmatically generate an image. By having the program, while it is running, produce a window and, in it, the image. Or, by having the program produce the image and save it in a image file (JPEG, PNG, TIFF, etc&#8230;), which can then be opened by an image viewer. This experiment deals with the latter.</p>
<p>I&#8217;ll be following the book <b>Ray Tracing in One Weekend</b>, it describes the processes of writing a Ray Tracer using C++. I am not a C++ programmer though, and do not think that simply rewriting code shown in a book as being a very effective learning methodology. Therefore I&#8217;ll try to re-implement this Ray Tracer using Ruby.</p>
<h4>The PPM image format</h4>
<p>There are many image formats available, most of them are very complex, PPM will be the format used throughout this experiment. Maybe I&#8217;ll change it later.</p>
<p>The code bellow (PPM image file) would produce a 3x2 pixel image of red, green, blue, yellow, white, and black colors. I commented a few lines in the snippet bellow to describe the PPM image format.</p>
<pre class="code ruby"><code class="ruby">
P3  # Set colors to ASCII

3 2 # Set file to 3 columns and 2 rows
255 # Set max color to 255

# Image content

255   0   0       0 255   0       0   0 255
255 255   0     255 255 255       0   0   0
</code></pre>
<h4>First gradient in Ruby</h4>
<p>Let&#8217;s begin with a simple image gradient. First we set the image size, then we store both dimensions as two arrays that will be iterated on later.</p>
<pre class="code ruby"><code class="ruby">
image_width = &lt;span style=&quot;color:#00D&quot;&gt;256&lt;/span&gt;
image_height = &lt;span style=&quot;color:#00D&quot;&gt;256&lt;/span&gt;
hor = (&lt;span style=&quot;color:#00D&quot;&gt;0&lt;/span&gt;..(image_width - &lt;span style=&quot;color:#00D&quot;&gt;1&lt;/span&gt;)).to_a
ver = hor.reverse
</code></pre>
<p><code>$stdout</code> is our door to the outside world, and whatever gets out of this file I&#8217;ll then pipe to a new file. And again, the snippet bellow sets up our image file as per PPM requirements.</p>
<pre class="code ruby"><code class="ruby">
&lt;span style=&quot;color:#d70&quot;&gt;$stdout&lt;/span&gt; &lt;&lt; &lt;span style=&quot;background-color:hsla(0,100%,50%,0.05)&quot;&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#D20&quot;&gt;P3&lt;/span&gt;&lt;span style=&quot;color:#b0b&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;&lt; image_width &lt;&lt; &lt;span style=&quot;background-color:hsla(0,100%,50%,0.05)&quot;&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#D20&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;&lt; image_height &lt;&lt; &lt;span style=&quot;background-color:hsla(0,100%,50%,0.05)&quot;&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#b0b&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color:#D20&quot;&gt;255&lt;/span&gt;&lt;span style=&quot;color:#b0b&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
</code></pre>
<p>And now for the fun part. Think of this as we were creating a 2D array of <a href="https://en.wikipedia.org/wiki/Tuple">3-tuple</a>. Line by line, and pixel by pixel. Each pixel is described by 3 integers, each of those is a RGB value. Notice that we first get a floating number between 0.0 and 1.0, that has to be normalized back to an integer between 0 and 255. And lastly <code>$stdout</code> spits out our 3 values, go down a line, and iterate again.</p>
<pre class="code ruby"><code class="ruby">
ver.each &lt;span style=&quot;color:#080;font-weight:bold&quot;&gt;do&lt;/span&gt; |ypx|
  hor.each &lt;span style=&quot;color:#080;font-weight:bold&quot;&gt;do&lt;/span&gt; |xpx|
    r = xpx.to_f / (image_width - &lt;span style=&quot;color:#00D&quot;&gt;1&lt;/span&gt;)
    g = ypx.to_f / (image_height - &lt;span style=&quot;color:#00D&quot;&gt;1&lt;/span&gt;)
    b = &lt;span style=&quot;color:#60E&quot;&gt;0.25&lt;/span&gt;

    ir = (r * &lt;span style=&quot;color:#60E&quot;&gt;255.999&lt;/span&gt;).to_i
    ig = (g * &lt;span style=&quot;color:#60E&quot;&gt;255.999&lt;/span&gt;).to_i
    ib = (b * &lt;span style=&quot;color:#60E&quot;&gt;255.999&lt;/span&gt;).to_i

    &lt;span style=&quot;color:#d70&quot;&gt;$stdout&lt;/span&gt; &lt;&lt; ir &lt;&lt; &lt;span style=&quot;background-color:hsla(0,100%,50%,0.05)&quot;&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#D20&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;&lt; ig &lt;&lt; &lt;span style=&quot;background-color:hsla(0,100%,50%,0.05)&quot;&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#D20&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;&lt; ib &lt;&lt; &lt;span style=&quot;background-color:hsla(0,100%,50%,0.05)&quot;&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color:#b0b&quot;&gt;\n&lt;/span&gt;&lt;span style=&quot;color:#710&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
  &lt;span style=&quot;color:#080;font-weight:bold&quot;&gt;end&lt;/span&gt;
&lt;span style=&quot;color:#080;font-weight:bold&quot;&gt;end&lt;/span&gt;
</code></pre>
<p>The creating-image-file part gets dealt by the command line. At least for now.</p>
<pre class="code shell"><code class="shell">
$ ruby raytracer.rb &gt; gradient.ppm
</code></pre>
<p>And since most places don&#8217;t know what to do with an PPM image file, we can must also convert it to whatever file format you prefer. I&#8217;m converting it to JPEG using ImageMagick.</p>
<pre class="code shell"><code class="shell">
$ convert gradient.ppm gradient.jpg
</code></pre>
<p><img src="./Raytracing/gradient.jpg" alt="./Raytracing/gradient.jpg" /></p>
<h4>Class vec3</h4>
<pre class="code ruby"><code class="ruby">
&lt;span style=&quot;color:#036;font-weight:bold&quot;&gt;Class&lt;/span&gt;
</code></pre>
</div></div>

      <div id="footer">
  Generated on Wed Apr 19 18:18:43 2023 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.1.2).
</div>

    </div>
  </body>
</html>